{% extends 'layout/main.html' %}
{% load static %}
{% load widget_tweaks %}


{% block content %}
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-lg-6 col-md-8 col-sm-10">
      <div class="card shadow-lg border-0 rounded-4">
        <!-- Card Header -->
        <div class="card-header bg-gradient-primary text-dark text-center rounded-top-4">
          <h3 class="mb-0">Edit Profile</h3>
        </div>

        <!-- Card Body -->
        <div class="card-body p-4">

          <form method="post" enctype="multipart/form-data">
            {% csrf_token %}

            <!-- Profile Picture Preview -->
            <div class="text-center mb-4">
              {% if user.profile.profile_image %}
              <img src="{{ user.profile.profile_image.url }}" alt="Profile Image"
                class="rounded-circle border border-3 border-secondary" width="120" height="120">
              {% else %}
              <img src="{% static 'images/default-profile.png' %}" alt="Profile Image"
                class="rounded-circle border border-3 border-secondary" width="120" height="120">
              {% endif %}
            </div>

            <!-- Username -->
            <div class="mb-3">
              <label for="id_username" class="form-label">
                <i class="bi bi-person-fill me-2"></i>Username
              </label>
              <input type="text" name="username" class="form-control rounded-pill" id="id_username"
                value="{{ user.username }}">
            </div>

            <!-- Email -->
            <div class="mb-3">
              <label for="id_email" class="form-label">
                <i class="bi bi-envelope-fill me-2"></i>Email
              </label>
              <input type="email" name="email" class="form-control rounded-pill" id="id_email" value="{{ user.email }}">
            </div>

            <!-- Other User Fields -->
            {% for field in user_form %}
            {% if field.name != 'username' and field.name != 'email' %}
            <div class="mb-3">
              {{ field.label_tag }}
              {{ field|add_class:"form-control rounded-pill" }}
              {% if field.help_text %}
              <small class="form-text text-muted">{{ field.help_text }}</small>
              {% endif %}
              {% for error in field.errors %}
              <div class="text-danger">{{ error }}</div>
              {% endfor %}
            </div>
            {% endif %}
            {% endfor %}

            <!-- Profile Form Fields -->
            {% for field in profile_form %}
            <div class="mb-3">
              {{ field.label_tag }}
              {{ field|add_class:"form-control rounded-pill" }}
              {% if field.help_text %}
              <small class="form-text text-muted">{{ field.help_text }}</small>
              {% endif %}
              {% for error in field.errors %}
              <div class="text-danger">{{ error }}</div>
              {% endfor %}
            </div>
            {% endfor %}

            <!-- Buttons -->
            <div class="d-flex flex-column flex-md-row justify-content-between mt-4">
              <button type="submit"
                class="btn btn-success btn-lg rounded-pill w-100 w-md-50 me-md-2 mb-2 mb-md-0 shadow-sm">
                <i class="bi bi-save-fill me-2"></i>Save Changes
              </button>
              <a href="{% url 'home' %}"
                class="btn btn-outline-danger btn-lg rounded-pill w-100 w-md-50 shadow-sm text-decoration-none text-center">
                <i class="bi bi-arrow-left-circle me-2"></i>Back
              </a>
            </div>

          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Bootstrap Icons CDN (if not already included in your layout/main.html) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

{% endblock %}